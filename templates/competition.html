{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block content %}


<div class="container text-center">
    <h4>Vote for the pup you think should win cutest pup of the month!</h4>
    
    <div class="row">
        {% for photo in photos %}
        <div class="col-12 col-md-6 col-lg-4">
            <div class="card card-bg my-3">
                <img src="{{ photo.image.url }}" alt="{{ photo.dog.name }}" class="img-fluid card-img-top">
                <div class="card-body">
                    <h5 class="card-title">{{ photo.dog.name }}</h5>
                    <p class="card-text">
                        Vote for {{ photo.dog.name }}
                    </p>
                    {% if user.is_authenticated %}
                        <form action="{% url 'photo_like' photo.id %}" method="POST">
                            {% csrf_token %}
                            {% if liked %}
                                <button type="submit" name="blogpost_id" value="{{photo.id}}" class="btn-like my-2"><i class="fas fa-heart"></i></button>
                            {% else %}
                                <button type="submit" name="blogpost_id" value="{{photo.id}}" class="btn-like my-2"><i class="far fa-heart"></i></button>
                            {% endif %}
                        </form>
                        {% if user == photo.dog.owner %}
                            <a href="{% url 'edit_photo' photo.id %}" class="btn btn-outline-secondary btn-sm" role="button">Update
                            </a>
                            <a href="#" class="btn btn-outline-danger btn-sm" role="button" data-bs-toggle="modal" data-bs-target="#modal-delete-{{photo.id}}">Delete
                            </a>
                            <div class="modal fade" id="modal-delete-{{photo.id}}" tabindex="-1" aria-labelledby="modal-delete-{{photo.id}}-label" aria-hidden="true">
                                <div class="modal-dialog">
                                  <div class="modal-content">
                                    <div class="modal-header">
                                      <h1 class="modal-title fs-5" id="modal-delete-{{photo.id}}-label">Delete Photo</h1>
                                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                      Are you sure you want to delete this photo?
                                      <br>
                                      <small>This action is permanent and cannot be undone.</small>
                                    </div>
                                    <div class="modal-footer">
                                      <button type="button" class="btn btn-success" data-bs-dismiss="modal">No</button>
                                      <a href="{% url 'delete_photo' photo.id %}" role="button" class="btn btn-danger">Yes</a>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            {% endif %}
                    {% else %}
                        <small>You must log in to vote in the competition!</small>
                        <span class="text-secondary"><i class="far fa-heart"></i></span>
                    {% endif %}
                    <span class="text-secondary">{{ photo.number_of_likes }} </span>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    <p id="vote-p"> 
        To vote for your favourite picture of the cutest dog for the month of November,
        all you have to do is click the heart to like the image and the picture with the 
        most hearts at the end of the month will win our doggy hamper!
        <br/>
        Good Luck ! 
    </p>

</div>

<div class="container text-left winners-p">
    <p>
        Winners will be announced and contacted on the last day of the month!
        Good Luck! 
    </p>
</div>
    
{% endblock %}